<!-- Modern Layout with Dynamic SEO - Centralizes all SEO meta tag generation-->
<!-- Uses articles.json data to automatically populate title, description, keywords-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Essential Meta Tags-->
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="color-scheme" content="light dark" />
        <!-- Content Security Policy for Google Analytics support-->
        <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com; connect-src 'self' https://www.googletagmanager.com https://www.google-analytics.com https://analytics.google.com https://region1.google-analytics.com https://region1.analytics.google.com https://stats.g.doubleclick.net; img-src 'self' data: https://www.google-analytics.com https://www.googletagmanager.com; style-src 'self' 'unsafe-inline'; font-src 'self'; worker-src 'self'; frame-src 'none'; object-src 'none'; base-uri 'self'; form-action 'self'" />
        <!-- Theme color for supported browsers (Chrome, Safari, Edge)-->
        <meta name="theme-color" content="#2c3e50" media="(prefers-color-scheme: light)" />
        <meta name="theme-color" content="#34495e" media="(prefers-color-scheme: dark)" />
        <!-- Dynamic SEO Meta Tags from articles.json-->
        <title>Interactive Chat in PromptSpark</title>
        <meta name="description" content="Discover how to build a real-time, AI-driven chat application in PromptSpark using ASP.NET SignalR and OpenAI GPT with Semantic Kernel. Enhance user" />
        <meta name="keywords" content="Mark Hazleton, PromptSpark, SignalR, Semantic Kernel, OpenAI GPT, real-time chat, AI-driven chat" />
        <meta name="author" content="Mark Hazleton" />
        <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
        <!-- Page-specific metadata block (optional overrides)-->
        <!-- Canonical URL-->
        <link rel="canonical" href="https://markhazleton.com/articles/interactive-chat-in-promptspark-with-signalr-and-semantic-kernel-chat-completions.html" />
        <!-- Default canonical override block (for backward compatibility)-->
        <!-- Open Graph Meta Tags - Optimized for LinkedIn Sharing-->
        <meta property="og:title" content="Interactive Chat in PromptSpark With SignalR" />
        <meta property="og:description" content="Discover how to build a real-time, AI-driven chat application in PromptSpark using ASP.NET SignalR and OpenAI GPT with Semantic Kernel. Enhance user" />
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://markhazleton.com/articles/interactive-chat-in-promptspark-with-signalr-and-semantic-kernel-chat-completions.html" />
        <meta property="og:image" content="https://markhazleton.com/assets/img/ArgostoliGreeceBeach.jpg" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="630" />
        <meta property="og:image:alt" content="Interactive Chat in PromptSpark With SignalR and Semantic Kernel Chat Completions - Mark Hazleton" />
        <meta property="og:site_name" content="Mark Hazleton" />
        <meta property="og:locale" content="en_US" />
        <!-- LinkedIn-specific optimizations-->
        <meta property="article:author" content="Mark Hazleton" />
        <meta property="article:published_time" content="2024-10-27" />
        <meta property="article:tag" content='{"articleTitle":"Interactive Chat in PromptSpark With SignalR"' />
        <meta property="article:tag" content='"articleDescription":"This article explores building a real-time chat application using ASP.NET SignalR and OpenAI&apos;s GPT models' />
        <meta property="article:tag" content='focusing on agility and efficiency in integration."' />
        <meta property="article:tag" content='"articleContent":"# Interactive Chat in PromptSpark With SignalR\n\n## Transitioning to a Simplified and Agile Approach\n\nThis article reimagines the approach from integrating chat completions into Prompt Spark' />
        <meta property="article:tag" content="focusing on agility and adaptability to meet the needs of a React Native component. By simplifying the integration" />
        <meta property="article:tag" content="the chat completions implementation becomes more efficient and effective" />
        <meta property="article:tag" content="embracing a continuous learning approach. This transition underscores the importance of staying open to better" />
        <meta property="article:tag" content="streamlined methods as new insights emerge" />
        <meta property="article:tag" content="allowing us to build more responsive" />
        <meta property="article:tag" content="user-centric applications.\n\n## Building an AI-driven" />
        <meta property="article:tag" content="Real-time Chat\n\nThis guide covers the steps to create an interactive chat experience using ASP.NET SignalR for real-time functionality and OpenAI's GPT models for intelligent responses" />
        <meta property="article:tag" content="through Semantic Kernel. The goal is to simplify and enhance the process of embedding chat completions" />
        <meta property="article:tag" content="making the design more efficient and ready for a VIT React Native environment.\n\n### Introduction\n\nIn this article" />
        <meta property="article:tag" content="developers and solution architects will learn how to integrate ASP.NET SignalR with Semantic Kernel's chat completion service to build a responsive" />
        <meta property="article:tag" content="intelligent chat application in PromptSpark. SignalR enables real-time communication" />
        <meta property="article:tag" content="while Semantic Kernel leverages OpenAI's GPT models for contextually relevant responses.\n\n### What You’ll Build and Why It Matters\n\nYou’ll create an interactive chat application where users receive immediate" />
        <meta property="article:tag" content="AI-generated responses" />
        <meta property="article:tag" content="closely simulating natural conversation flow. Combining SignalR's real-time messaging and Semantic Kernel's adaptive AI enhances engagement" />
        <meta property="article:tag" content="suitable for use cases like customer support" />
        <meta property="article:tag" content="virtual assistants" />
        <meta property="article:tag" content="and interactive content.\n\n### Setting Up Your Development Environment\n\nThis project requires ASP.NET Core" />
        <meta property="article:tag" content="SignalR" />
        <meta property="article:tag" content="and Semantic Kernel. Follow these steps to set up your environment and secure your OpenAI API keys with environment variables.\n\n```bash\ndotnet add package Microsoft.AspNetCore.SignalR\ndotnet add package Microsoft.SemanticKernel\n```\n\n### Setting Up Program.cs\n\nIn this section" />
        <meta property="article:tag" content="we’ll set up the main program configuration in `Program.cs` for the integration of SignalR and OpenAI’s GPT models via Semantic Kernel. This configuration ensures real-time functionality and prepares the AI chat service for prompt responses.\n\n#### Logging Configuration\n\nAdd console logging for debugging and set a debug level to capture detailed information.\n\n```csharp\nbuilder.Logging.AddConsole();\nbuilder.Logging.SetMinimumLevel(LogLevel.Debug);\n```\n\n#### SignalR Setup\n\nAdd SignalR to the services" />
        <meta property="article:tag" content="enabling real-time messaging capabilities in the application.\n\n```csharp\nbuilder.Services.AddSignalR();\n```\n\n#### OpenAI API Integration\n\nConfigure Semantic Kernel’s `AddOpenAIChatCompletion` service" />
        <meta property="article:tag" content='using API keys stored in environment variables. Ensure the environment variables `OPENAI_API_KEY` and `MODEL_ID` are correctly set to avoid errors.\n\n```csharp\nstring apikey = builder.Configuration.GetValue&lt;string&gt;(\"OPENAI_API_KEY\") ?? \"not found\";\nstring modelId = builder.Configuration.GetValue&lt;string&gt;(\"MODEL_ID\") ?? \"gpt-4o\";\nbuilder.Services.AddOpenAIChatCompletion(modelId' />
        <meta property="article:tag" content="apikey);\n```\n\n#### Routing and Middleware\n\nMap routes for API controllers and the SignalR `ChatHub`" />
        <meta property="article:tag" content="enabling endpoint access and serving static files like the front-end HTML.\n\n```csharp\nvar app = builder.Build();\napp.UseDefaultFiles();  // Looks for index.html" />
        <meta property="article:tag" content='index.htm by default\napp.UseStaticFiles();\n\napp.MapControllers();\napp.MapHub&lt;ChatHub&gt;(\"/chatHub\");\n```\n\n### Implementing the SignalR Chat Hub\n\nThe ChatHub manages messages' />
        <meta property="article:tag" content="maintains conversation history" />
        <meta property="article:tag" content="and processes real-time user interactions. Below is the implementation of the `ChatHub` class" />
        <meta property="article:tag" content="which initializes with an instance of `IChatCompletionService` and manages message flow with a `ConcurrentDictionary` for chat history.\n\n```csharp\npublic class ChatHub(IChatCompletionService _chatCompletionService) : Hub\n{\n  public class ChatEntry\n  {\n    public DateTime Timestamp { get; set; }\n    public string User { get; set; }\n    public string UserMessage { get; set; }\n    public string BotResponse { get; set; }\n  }\n\n  private static readonly ConcurrentDictionary&lt;string" />
        <meta property="article:tag" content="List&lt;ChatEntry&gt;&gt; ChatHistoryCache = new();\n\n  public async Task SendMessage(string user" />
        <meta property="article:tag" content="string message" />
        <meta property="article:tag" content='string conversationId)\n  {\n    if (!ChatHistoryCache.ContainsKey(conversationId))\n    {\n      ChatHistoryCache[conversationId] = new List&lt;ChatEntry&gt;();\n    }\n    var timestamp = DateTime.Now;\n\n    // Broadcast user&apos;s message\n    await Clients.All.SendAsync(\"ReceiveMessage\"' />
        <meta property="article:tag" content="user" />
        <meta property="article:tag" content="message" />
        <meta property="article:tag" content='conversationId);\n\n    var chatHistory = new ChatHistory();\n    chatHistory.AddSystemMessage(\"You are in a conversation' />
        <meta property="article:tag" content="keep your answers brief" />
        <meta property="article:tag" content="always ask follow-up questions" />
        <meta property="article:tag" content='ask if ready for full answer.\");\n\n    foreach (var chatEntry in ChatHistoryCache[conversationId])\n    {\n      chatHistory.AddUserMessage(chatEntry.UserMessage);\n      chatHistory.AddSystemMessage(chatEntry.BotResponse);\n    }\n    chatHistory.AddUserMessage(message);\n\n    // Generate bot response with streaming\n    var botResponse = await GenerateStreamingBotResponse(chatHistory' />
        <meta property="article:tag" content="conversationId);\n\n    // Add the message to the in-memory cache\n    ChatHistoryCache[conversationId].Add(new ChatEntry\n    {\n      Timestamp = timestamp" />
        <meta property="article:tag" content="\n      User = user" />
        <meta property="article:tag" content="\n      UserMessage = message" />
        <meta property="article:tag" content="\n      BotResponse = botResponse\n    });\n  }\n\n  private async Task&lt;string&gt; GenerateStreamingBotResponse(ChatHistory chatHistory" />
        <meta property="article:tag" content="string conversationId)\n  {\n    var buffer = new StringBuilder();\n    var message = new StringBuilder();\n    try\n    {\n      await foreach (var response in _chatCompletionService.GetStreamingChatMessageContentsAsync(chatHistory))\n      {\n        if (response?.Content != null)\n        {\n          buffer.Append(response.Content);\n\n          if (response.Content.Contains('\\n'))\n          {\n            var contentToSend = buffer.ToString();\n            await Clients.All.SendAsync(\&quot;ReceiveMessage\&quot;" />
        <meta property="article:tag" content='\"ChatBot\"' />
        <meta property="article:tag" content="contentToSend" />
        <meta property="article:tag" content="conversationId);\n            await AppendToCsvLog(conversationId" />
        <meta property="article:tag" content='\"System\"' />
        <meta property="article:tag" content='contentToSend);\n            message.Append(contentToSend);\n            buffer.Clear();\n          }\n        }\n      }\n\n      if (buffer.Length &gt; 0)\n      {\n        var remainingContent = buffer.ToString();\n        await Clients.All.SendAsync(\"ReceiveMessage\"' />
        <meta property="article:tag" content='\"ChatBot\"' />
        <meta property="article:tag" content="remainingContent" />
        <meta property="article:tag" content="conversationId);\n        message.Append(remainingContent);\n        await AppendToCsvLog(conversationId" />
        <meta property="article:tag" content='\"System\"' />
        <meta property="article:tag" content='remainingContent);\n      }\n    }\n    catch (Exception ex)\n    {\n      Console.WriteLine($\"Error in generating bot response: {ex.Message}\");\n      message.Append(\"An error occurred while processing your request.\");\n      await Clients.Caller.SendAsync(\"ReceiveMessage\"' />
        <meta property="article:tag" content='\"System\"' />
        <meta property="article:tag" content='\"An error occurred while processing your request.\");\n    }\n    return message.ToString();\n  }\n\n  private async Task AppendToCsvLog(string conversationId' />
        <meta property="article:tag" content="string sender" />
        <meta property="article:tag" content='string message)\n  {\n    Console.WriteLine($\"{DateTime.Now}' />
        <meta property="article:tag" content="{conversationId}" />
        <meta property="article:tag" content='{sender}: {message}\");\n  }\n}\n```\n\n### Generating AI-Powered Responses with Semantic Kernel\n\nThe `GenerateStreamingBotResponse` method in the ChatHub class generates responses asynchronously. This method streams responses to the client in real-time' />
        <meta property="article:tag" content='providing a continuous \"typing\" effect for a more dynamic chat experience.\n\n### Building the Front-End for PromptSpark Chat\n\nSet up a user-friendly interface with an input box' />
        <meta property="article:tag" content="chat history window" />
        <meta property="article:tag" content="and “send” button. Establish a SignalR connection for real-time messaging" />
        <meta property="article:tag" content='and use streaming for a “typing” effect in AI responses.\n\n```javascript\nconst connection = new signalR.HubConnectionBuilder()\n  .withUrl(\"/chathub\")\n  .build();\n\nconnection.on(\"ReceiveMessage\"' />
        <meta property="article:tag" content="(user" />
        <meta property="article:tag" content="message" />
        <meta property="article:tag" content="conversationId) =&gt; {\n  // Display received messages\n});\n```\n\n### Front-End Testing with index.html\n\nCreate a simple test harness 'index.html' in the wwwroot folder for the interactive chat interface. It provides a basic layout with Bootstrap styling" />
        <meta
            property="article:tag"
            content='enabling users to send messages and view responses in real-time.\n\n```html\n&lt;div class=\"card\"&gt;\n  &lt;div class=\"card-header text-center\"&gt;\n    &lt;h2&gt;PromptSpark Chat&lt;/h2&gt;\n  &lt;/div&gt;\n  &lt;div class=\"card-body\"&gt;\n    &lt;div id=\"userForm\" class=\"mb-4\"&gt;\n      &lt;label for=\"userInput\" class=\"form-label\"&gt;Enter your name to join the chat:&lt;/label&gt;\n      &lt;input type=\"text\" id=\"userInput\" class=\"form-control\" placeholder=\"Your name\" /&gt;\n      &lt;button class=\"btn btn-primary mt-2\" onclick=\"joinChat()\"&gt;Join Chat&lt;/button&gt;\n    &lt;/div&gt;\n    &lt;div id=\"chatWindow\" style=\"display: none;\"&gt;\n      &lt;ul id=\"messagesList\" class=\"list-unstyled mb-3 p-3 border rounded bg-white\" style=\"height: 300px; overflow-y: scroll;\"&gt;\n      &lt;/ul&gt;\n      &lt;div class=\"input-group\"&gt;\n        &lt;input type=\"text\" id=\"messageInput\" class=\"form-control\" placeholder=\"Type your message here...\" /&gt;\n        &lt;button class=\"btn btn-primary\" onclick=\"sendMessage()\"&gt;Send&lt;/button&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n```\n\nAdd the following JavaScript code to the &apos;index.html&apos; file to establish a SignalR connection and handle real-time messaging.\n\n```javascript\nconst connection = new signalR.HubConnectionBuilder()\n  .withUrl(\"/chatHub\")\n  .configureLogging(signalR.LogLevel.Information)\n  .build();\n\nlet userName = \"\";\nlet conversationId = localStorage.getItem(\"conversationId\") || generateConversationId();\nlet botMessageElement = null;\nlocalStorage.setItem(\"conversationId\"'
        />
        <meta property="article:tag" content="conversationId);\n\nfunction generateConversationId() {\n  return Math.random().toString(36).substring(2" />
        <meta property="article:tag" content='15);\n}\n\nasync function start() {\n  try {\n    await connection.start();\n    console.log(\"Connected to SignalR hub!\");\n  } catch (err) {\n    console.error(\"Connection failed: \"' />
        <meta property="article:tag" content="err);\n    setTimeout(start" />
        <meta property="article:tag" content='5000);\n  }\n}\n\nconnection.on(\"ReceiveMessage\"' />
        <meta property="article:tag" content="(user" />
        <meta property="article:tag" content='message) =&gt; {\n  const messagesList = document.getElementById(\"messagesList\");\n\n  if (user === \"ChatBot\") {\n    if (!botMessageElement) {\n      botMessageElement = document.createElement(\"li\");\n      botMessageElement.classList.add(\"mb-2\");\n      botMessageElement.setAttribute(\"data-user\"' />
        <meta
            property="article:tag"
            content='\"ChatBot\");\n      botMessageElement.innerHTML = `&lt;strong&gt;${user}:&lt;/strong&gt; &lt;span class=\"bot-message-content\"&gt;&lt;/span&gt;`;\n      messagesList.appendChild(botMessageElement);\n    }\n    botMessageElement.querySelector(\".bot-message-content\").textContent += message + \" \";\n  } else {\n    botMessageElement = null;\n    const li = document.createElement(\"li\");\n    li.classList.add(\"mb-2\");\n    li.innerHTML = `&lt;strong&gt;${user}:&lt;/strong&gt; ${message}`;\n    messagesList.appendChild(li);\n  }\n  messagesList.scrollTop = messagesList.scrollHeight;\n});\n\nfunction joinChat() {\n  userName = document.getElementById(\"userInput\").value.trim();\n  if (userName) {\n    document.getElementById(\"userForm\").style.display = \"none\";\n    document.getElementById(\"chatWindow\").style.display = \"block\";\n    document.getElementById(\"messageInput\").focus();\n  }\n}\n\nasync function sendMessage() {\n  const message = document.getElementById(\"messageInput\").value.trim();\n  if (userName &amp;&amp; message) {\n    try {\n      await connection.invoke(\"SendMessage\"'
        />
        <meta property="article:tag" content="userName" />
        <meta property="article:tag" content="message" />
        <meta property="article:tag" content='conversationId);\n      document.getElementById(\"messageInput\").value = &apos;&apos;;\n    } catch (err) {\n      console.error(\"SendMessage failed: \"' />
        <meta property="article:tag" content='err);\n    }\n  }\n}\n\ndocument.getElementById(\"messageInput\").addEventListener(\"keypress\"' />
        <meta property="article:tag" content='function (event) {\n  if (event.key === \"Enter\") {\n    event.preventDefault();\n    sendMessage();\n  }\n});\n\nstart();\n```\n\n#### SignalR Connection\n\nEstablishes a real-time connection with the SignalR hub. This is some simple JavaScript code that connects to the SignalR hub and logs a message to the console when the connection is successful.\n\n```javascript\nconst connection = new signalR.HubConnectionBuilder()\n  .withUrl(\"/chathub\")\n  .build();\n\nconnection.on(\"ReceiveMessage\"' />
        <meta property="article:tag" content="(user" />
        <meta property="article:tag" content="message" />
        <meta property="article:tag" content="conversationId) =&gt; {\n  // Display received messages\n});\n```\n\n#### User Interaction\n\nProvides a join functionality with a unique conversation" />
        <!-- YouTube video Open Graph tags-->
        <!-- Additional Open Graph overrides (for backward compatibility)-->
        <!-- Twitter Card Meta Tags-->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@markhazleton" />
        <meta name="twitter:creator" content="@markhazleton" />
        <meta name="twitter:title" content="Interactive Chat in PromptSpark" />
        <meta name="twitter:description" content="Discover how to build a real-time, AI-driven chat application in PromptSpark using ASP.NET SignalR and OpenAI GPT with Semantic Kernel. Enhance user" />
        <meta name="twitter:image" content="https://markhazleton.com/assets/img/ArgostoliGreeceBeach.jpg" />
        <meta name="twitter:image:alt" content="Interactive Chat in PromptSpark With SignalR and Semantic Kernel Chat Completions - Mark Hazleton" />
        <!-- YouTube video Twitter Card tags-->
        <!-- Additional Twitter Card overrides (for backward compatibility)-->
        <!-- Performance optimization - No external CDN dependencies-->
        <!-- Favicon and app icons-->
        <link rel="shortcut icon" href="/assets/img/favicon.ico" />
        <link rel="icon" type="image/x-icon" href="/assets/img/favicon.ico" />
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
        <link rel="manifest" href="/site.webmanifest" />
        <!-- RSS Feeds - Articles and Projects-->
        <link rel="alternate" type="application/rss+xml" title="Mark Hazleton Articles" href="/rss.xml" />
        <link rel="alternate" type="application/rss+xml" title="Mark Hazleton Projects" href="/projects-rss.xml" />
        <!-- Modern Layout Styles (includes Bootstrap 5, Bootstrap Icons, Font Awesome, PrismJS)-->
        <link href="/css/modern-styles.css" rel="stylesheet" />
        <!-- Enhanced JSON-LD Structured Data for SEO-->
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "Person",
                "name": "Mark Hazleton",
                "givenName": "Mark",
                "familyName": "Hazleton",
                "jobTitle": "Solutions Architect",
                "description": "Solutions Architect passionate for solutions which make technology work for business",
                "url": "https://markhazleton.com",
                "image": {
                    "@type": "ImageObject",
                    "url": "https://markhazleton.com/assets/img/MarkHazleton.jpg",
                    "width": 400,
                    "height": 400
                },
                "sameAs": ["https://www.linkedin.com/in/markhazleton/", "https://github.com/markhazleton/", "https://twitter.com/markhazleton/", "https://www.youtube.com/@MarkHazleton"],
                "knowsAbout": [".NET Framework", "ASP.NET Core", "Microsoft Azure", "Project Management", "Web Development", "Solution Architecture", "Software Engineering", "Cloud Computing", "Artificial Intelligence", "Machine Learning"],
                "alumniOf": {
                    "@type": "Organization",
                    "name": "University of North Texas"
                },
                "address": {
                    "@type": "PostalAddress",
                    "addressLocality": "Wichita",
                    "addressRegion": "KS",
                    "addressCountry": "US"
                },
                "mainEntityOfPage": {
                    "@type": "WebPage",
                    "@id": "https://markhazleton.com/"
                }
            }
        </script>
        <!-- Additional structured data for specific pages-->
        <!-- Additional page-specific CSS-->
        <!-- Include LinkedIn sharing mixins-->
        <!-- Global site tag (gtag.js) - Google Analytics-->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-L8GVZNDH0B" async></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());
            gtag('config', 'G-L8GVZNDH0B');
        </script>
    </head>
    <body>
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" role="navigation" aria-label="Main navigation">
            <div class="container-fluid">
                <a class="navbar-brand" href="/#" aria-label="Mark Hazleton homepage">Mark Hazleton</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item"><a class="nav-link active" href="/#about" aria-current="page">About Mark</a></li>
                        <li class="nav-item"><a class="nav-link" href="/projects.html">Projects</a></li>
                        <li class="nav-item"><a class="nav-link" href="/articles.html">Articles</a></li>
                    </ul>
                    <!-- Search Box - Inside collapsible navbar-->
                    <form class="d-flex me-3 my-2 my-lg-0" onsubmit="return searchArticles(event)">
                        <div class="input-group search-box">
                            <input class="form-control" id="headerSearchInput" type="search" placeholder="Search articles..." aria-label="Search articles" autocomplete="off" />
                            <button class="btn btn-outline-light" type="submit" aria-label="Search"><i class="fas fa-search"></i></button>
                        </div>
                    </form>
                    <!-- Social Icons - Inside collapsible navbar-->
                    <div class="d-flex social-icons">
                        <a href="https://www.linkedin.com/in/markhazleton/" target="_blank" rel="noopener noreferrer" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                            <span class="visually-hidden">LinkedIn Profile</span>
                        </a>
                        <a href="https://github.com/markhazleton/" target="_blank" rel="noopener noreferrer" title="GitHub">
                            <i class="fab fa-github"></i>
                            <span class="visually-hidden">GitHub Profile</span>
                        </a>
                        <a href="https://www.youtube.com/@MarkHazleton" target="_blank" rel="noopener noreferrer" title="YouTube">
                            <i class="fab fa-youtube"></i>
                            <span class="visually-hidden">YouTube Channel</span>
                        </a>
                        <a href="/rss.xml" target="_blank" rel="noopener noreferrer" title="Articles RSS Feed">
                            <i class="fas fa-rss"></i>
                            <span class="visually-hidden">Articles RSS Feed</span>
                        </a>
                        <a href="/projects-rss.xml" target="_blank" rel="noopener noreferrer" title="Projects RSS Feed">
                            <i class="fas fa-rss text-warning"></i>
                            <span class="visually-hidden">Projects RSS Feed</span>
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>
            </div>
        </nav>
        <br />
        <br />
        <!-- Hero Section-->
        <section class="bg-gradient-primary py-5">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-10 mx-auto text-center">
                        <h1 class="display-4 fw-bold mb-3">
                            <i class="bi bi-cloud me-3"></i>
                            Interactive Chat in PromptSpark With SignalR
                        </h1>
                        <h2 class="subheading mb-4">Transitioning to a Simplified and Agile Approach</h2>
                    </div>
                </div>
            </div>
        </section>
        <!-- Main Article Content-->
        <article id="main-article">
            <div class="container">
                <div class="row">
                    <p>
                        This article reimagines the approach from
                        <a href="/articles/integrating-chat-completions-into-prompt-spark.html">Integrating Chat Completions into Prompt Spark,</a>
                        focusing on agility and adaptability to meet the needs of a React Native component. By simplifying the integration, I want to make the chat completions implementation more efficient and effective, embracing a continuous learning approach. This transition underscores the importance of staying open to better, streamlined methods as new insights emerge, allowing us to build more responsive, user-centric applications.
                    </p>
                    <h2 class="subheading mb-3">Building an AI-driven, real-time chat using ASP.NET SignalR and OpenAI's GPT models via Semantic Kernel</h2>
                    <p>This guide covers the steps to create an interactive chat experience using ASP.NET SignalR for real-time functionality and OpenAI's GPT models for intelligent responses, through Semantic Kernel.</p>
                    <p>In this new article, I am refining the approach introduced in the original "Integrating Chat Completions into Prompt Spark," focusing on a more agile and adaptable structure. As I explore this updated implementation, the goal is to simplify and enhance the process of embedding chat completions, making the design more efficient and ready for a VIT React Native environment. This transition reflects a commitment to continuous improvement, staying open to evolving insights that reveal better, streamlined methods.</p>
                    <dl>
                        <dt>Introduction</dt>
                        <dd><p>In this article, developers and solution architects will learn how to integrate ASP.NET SignalR with Semantic Kernel's chat completion service to build a responsive, intelligent chat application in PromptSpark. SignalR enables real-time communication, while Semantic Kernel leverages OpenAI's GPT models for contextually relevant responses.</p></dd>
                        <dt>What You’ll Build and Why It Matters</dt>
                        <dd><p>You’ll create an interactive chat application where users receive immediate, AI-generated responses, closely simulating natural conversation flow. Combining SignalR's real-time messaging and Semantic Kernel's adaptive AI enhances engagement, suitable for use cases like customer support, virtual assistants, and interactive content.</p></dd>
                        <dt>Setting Up Your Development Environment</dt>
                        <dd>
                            <p>This project requires ASP.NET Core, SignalR, and Semantic Kernel. Follow these steps to set up your environment and secure your OpenAI API keys with environment variables.</p>
                            <pre class="language-bash"><code class="language-bash">dotnet <span class="token function">add</span> package Microsoft.AspNetCore.SignalR
dotnet <span class="token function">add</span> package Microsoft.SemanticKernel
</code></pre>
                        </dd>
                        <dt>Setting Up Program.cs</dt>
                        <dd>
                            <p>In this section, we’ll set up the main program configuration in `Program.cs` for the integration of SignalR and OpenAI’s GPT models via Semantic Kernel. This configuration ensures real-time functionality and prepares the AI chat service for prompt responses.</p>
                            <dl>
                                <dt>Logging Configuration</dt>
                                <dd>
                                    <p>Add console logging for debugging and set a debug level to capture detailed information. pre.language-csharp</p>
                                    <pre class="language-csharp"><code class="language-csharp">builder<span class="token punctuation">.</span>Logging<span class="token punctuation">.</span><span class="token function">AddConsole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
builder<span class="token punctuation">.</span>Logging<span class="token punctuation">.</span><span class="token function">SetMinimumLevel</span><span class="token punctuation">(</span>LogLevel<span class="token punctuation">.</span>Debug<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                                </dd>
                                <dt>SignalR Setup</dt>
                                <dd>
                                    <p>Add SignalR to the services, enabling real-time messaging capabilities in the application.</p>
                                    <pre class="language-csharp"><code class="language-csharp">builder<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddSignalR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                                </dd>
                                <dt>OpenAI API Integration</dt>
                                <dd>
                                    <p>Configure Semantic Kernel’s `AddOpenAIChatCompletion` service, using API keys stored in environment variables. Ensure the environment variables `OPENAI_API_KEY` and `MODEL_ID` are correctly set to avoid errors.</p>
                                    <pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">string</span></span> apikey <span class="token operator">=</span> builder<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetValue</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"OPENAI_API_KEY"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">"not found"</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span> modelId <span class="token operator">=</span> builder<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetValue</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"MODEL_ID"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">"gpt-4o"</span><span class="token punctuation">;</span>
builder<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddOpenAIChatCompletion</span><span class="token punctuation">(</span>modelId<span class="token punctuation">,</span> apikey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                                </dd>
                                <dt>Routing and Middleware</dt>
                                <dd>
                                    <p>Map routes for API controllers and the SignalR `ChatHub`, enabling endpoint access and serving static files like the front-end HTML.</p>
                                    <pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">UseDefaultFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Looks for index.html, index.htm by default</span>
app<span class="token punctuation">.</span><span class="token function">UseStaticFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">MapControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">MapHub</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ChatHub<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token string">"/chatHub"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                                </dd>
                            </dl>
                        </dd>
                        <dt>Implementing the SignalR Chat Hub</dt>
                        <dd>
                            <p>The ChatHub manages messages, maintains conversation history, and processes real-time user interactions. Below is the implementation of the `ChatHub` class, which initializes with an instance of `IChatCompletionService` and manages message flow with a `ConcurrentDictionary` for chat history.</p>
                            <pre class="language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatHub</span><span class="token punctuation">(</span><span class="token class-name">IChatCompletionService</span> _chatCompletionService<span class="token punctuation">)</span> <span class="token punctuation">:</span> Hub
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatEntry</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">DateTime</span> Timestamp <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> User <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> UserMessage <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> BotResponse <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> List<span class="token punctuation">&lt;</span>ChatEntry<span class="token punctuation">></span><span class="token punctuation">></span></span> ChatHistoryCache <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> user<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> message<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> conversationId<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ChatHistoryCache<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>conversationId<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      ChatHistoryCache<span class="token punctuation">[</span>conversationId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>ChatEntry<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name"><span class="token keyword">var</span></span> timestamp <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">;</span>

    <span class="token comment">// Broadcast user's message</span>
    <span class="token keyword">await</span> Clients<span class="token punctuation">.</span>All<span class="token punctuation">.</span><span class="token function">SendAsync</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> user<span class="token punctuation">,</span> message<span class="token punctuation">,</span> conversationId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword">var</span></span> chatHistory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ChatHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    chatHistory<span class="token punctuation">.</span><span class="token function">AddSystemMessage</span><span class="token punctuation">(</span><span class="token string">"You are in a conversation, keep your answers brief, always ask follow-up questions, ask if ready for full answer."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> chatEntry <span class="token keyword">in</span> ChatHistoryCache<span class="token punctuation">[</span>conversationId<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      chatHistory<span class="token punctuation">.</span><span class="token function">AddUserMessage</span><span class="token punctuation">(</span>chatEntry<span class="token punctuation">.</span>UserMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
      chatHistory<span class="token punctuation">.</span><span class="token function">AddSystemMessage</span><span class="token punctuation">(</span>chatEntry<span class="token punctuation">.</span>BotResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    chatHistory<span class="token punctuation">.</span><span class="token function">AddUserMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Generate bot response with streaming</span>
    <span class="token class-name"><span class="token keyword">var</span></span> botResponse <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">GenerateStreamingBotResponse</span><span class="token punctuation">(</span>chatHistory<span class="token punctuation">,</span> conversationId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Add the message to the in-memory cache</span>
    ChatHistoryCache<span class="token punctuation">[</span>conversationId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ChatEntry</span>
    <span class="token punctuation">{</span>
      Timestamp <span class="token operator">=</span> timestamp<span class="token punctuation">,</span>
      User <span class="token operator">=</span> user<span class="token punctuation">,</span>
      UserMessage <span class="token operator">=</span> message<span class="token punctuation">,</span>
      BotResponse <span class="token operator">=</span> botResponse
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span> <span class="token function">GenerateStreamingBotResponse</span><span class="token punctuation">(</span><span class="token class-name">ChatHistory</span> chatHistory<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> conversationId<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> message <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">await</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token keyword">in</span> _chatCompletionService<span class="token punctuation">.</span><span class="token function">GetStreamingChatMessageContentsAsync</span><span class="token punctuation">(</span>chatHistory<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">?.</span>Content <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          buffer<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Content<span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>Content<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token char">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> contentToSend <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">await</span> Clients<span class="token punctuation">.</span>All<span class="token punctuation">.</span><span class="token function">SendAsync</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> <span class="token string">"ChatBot"</span><span class="token punctuation">,</span> contentToSend<span class="token punctuation">,</span> conversationId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">await</span> <span class="token function">AppendToCsvLog</span><span class="token punctuation">(</span>conversationId<span class="token punctuation">,</span> <span class="token string">"System"</span><span class="token punctuation">,</span> contentToSend<span class="token punctuation">)</span><span class="token punctuation">;</span>
            message<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>contentToSend<span class="token punctuation">)</span><span class="token punctuation">;</span>
            buffer<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>buffer<span class="token punctuation">.</span>Length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> remainingContent <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> Clients<span class="token punctuation">.</span>All<span class="token punctuation">.</span><span class="token function">SendAsync</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> <span class="token string">"ChatBot"</span><span class="token punctuation">,</span> remainingContent<span class="token punctuation">,</span> conversationId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>remainingContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> <span class="token function">AppendToCsvLog</span><span class="token punctuation">(</span>conversationId<span class="token punctuation">,</span> <span class="token string">"System"</span><span class="token punctuation">,</span> remainingContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error in generating bot response: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      message<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">"An error occurred while processing your request."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">await</span> Clients<span class="token punctuation">.</span>Caller<span class="token punctuation">.</span><span class="token function">SendAsync</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> <span class="token string">"System"</span><span class="token punctuation">,</span> <span class="token string">"An error occurred while processing your request."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> message<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">AppendToCsvLog</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> conversationId<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> sender<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> message<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">DateTime<span class="token punctuation">.</span>Now</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">conversationId</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">sender</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
                        </dd>
                        <dt>Generating AI-Powered Responses with Semantic Kernel</dt>
                        <dd><p>The `GenerateStreamingBotResponse` method in the ChatHub class generates responses asynchronously. This method streams responses to the client in real-time, providing a continuous "typing" effect for a more dynamic chat experience.</p></dd>
                        <dt>Building the Front-End for PromptSpark Chat</dt>
                        <dd>
                            <p>Set up a user-friendly interface with an input box, chat history window, and “send” button. Establish a SignalR connection for real-time messaging, and use streaming for a “typing” effect in AI responses.</p>
                            <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">signalR<span class="token punctuation">.</span>HubConnectionBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">withUrl</span><span class="token punctuation">(</span><span class="token string">"/chathub"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span> message<span class="token punctuation">,</span> conversationId</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Display received messages</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre>
                        </dd>
                        <dt>Front-End Testing with index.html</dt>
                        <dd>
                            <p>Create a simple test harness 'index.html' in the wwwwroot folder for the interactive chat interface. It provides a basic layout with Bootstrap styling, enabling users to send messages and view responses in real-time.</p>
                            <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-header text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>PromptSpark Chat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userForm<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userInput<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter your name to join the chat:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userInput<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Your name<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary mt-2<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">joinChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>Join Chat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chatWindow<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>messagesList<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list-unstyled mb-3 p-3 border rounded bg-white<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token property">overflow-y</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>input-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>messageInput<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Type your message here...<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>Send<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre>
                            <p>Add the following JavaScript code to the 'index.html' file to establish a SignalR connection and handle real-time messaging.</p>
                            <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">signalR<span class="token punctuation">.</span>HubConnectionBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">withUrl</span><span class="token punctuation">(</span><span class="token string">"/chatHub"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">configureLogging</span><span class="token punctuation">(</span>signalR<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LogLevel</span></span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Information</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> userName <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> conversationId <span class="token operator">=</span> <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">"conversationId"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">generateConversationId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> botMessageElement <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">setItem</span><span class="token punctuation">(</span><span class="token string">"conversationId"</span><span class="token punctuation">,</span> conversationId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">generateConversationId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> connection<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Connected to SignalR hub!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Connection failed: "</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> messagesList <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"messagesList"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>user <span class="token operator">===</span> <span class="token string">"ChatBot"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>botMessageElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      botMessageElement <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      botMessageElement<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">"mb-2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      botMessageElement<span class="token punctuation">.</span><span class="token method function property-access">setAttribute</span><span class="token punctuation">(</span><span class="token string">"data-user"</span><span class="token punctuation">,</span> <span class="token string">"ChatBot"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      botMessageElement<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token html language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token interpolation-punctuation punctuation">}</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bot-message-content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      messagesList<span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span>botMessageElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    botMessageElement<span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">".bot-message-content"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">textContent</span> <span class="token operator">+=</span> message <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    botMessageElement <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> li <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    li<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">"mb-2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    li<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token html language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token interpolation-punctuation punctuation">}</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> <span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    messagesList<span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  messagesList<span class="token punctuation">.</span><span class="token property-access">scrollTop</span> <span class="token operator">=</span> messagesList<span class="token punctuation">.</span><span class="token property-access">scrollHeight</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">joinChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  userName <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"userInput"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"userForm"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"chatWindow"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"messageInput"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"messageInput"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>userName <span class="token operator">&amp;&amp;</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">await</span> connection<span class="token punctuation">.</span><span class="token method function property-access">invoke</span><span class="token punctuation">(</span><span class="token string">"SendMessage"</span><span class="token punctuation">,</span> userName<span class="token punctuation">,</span> message<span class="token punctuation">,</span> conversationId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"messageInput"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"SendMessage failed: "</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"messageInput"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"keypress"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">key</span> <span class="token operator">===</span> <span class="token string">"Enter"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <dl>
                                <dt>SignalR Connection</dt>
                                <dd>
                                    <p>Establishes a real-time connection with the SignalR hub. This is some simple javascript code that connects to the SignalR hub and logs a message to the console when the connection is successful.</p>
                                    <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">signalR<span class="token punctuation">.</span>HubConnectionBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">withUrl</span><span class="token punctuation">(</span><span class="token string">"/chathub"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span> message<span class="token punctuation">,</span> conversationId</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Display received messages</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                                </dd>
                                <dt>User Interaction</dt>
                                <dd>
                                    <p>Provides a join functionality with a unique conversation ID per session.</p>
                                    <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">joinChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  userName <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"userInput"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"userForm"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"chatWindow"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"messageInput"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
                                </dd>
                                <dt>Real-Time Messaging</dt>
                                <dd>
                                    <p>Updates the chat window in real time with both user and bot messages, including a “typing” effect for bot responses.</p>
                                    <pre class="language-javascript"><code class="language-javascript">connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">"ReceiveMessage"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> messagesList <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"messagesList"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>user <span class="token operator">===</span> <span class="token string">"ChatBot"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>botMessageElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      botMessageElement <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      botMessageElement<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">"mb-2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      botMessageElement<span class="token punctuation">.</span><span class="token method function property-access">setAttribute</span><span class="token punctuation">(</span><span class="token string">"data-user"</span><span class="token punctuation">,</span> <span class="token string">"ChatBot"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      botMessageElement<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token html language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token interpolation-punctuation punctuation">}</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bot-message-content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      messagesList<span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span>botMessageElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    botMessageElement<span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">".bot-message-content"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">textContent</span> <span class="token operator">+=</span> message <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    botMessageElement <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> li <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    li<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">"mb-2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    li<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token html language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token interpolation-punctuation punctuation">}</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> <span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    messagesList<span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  messagesList<span class="token punctuation">.</span><span class="token property-access">scrollTop</span> <span class="token operator">=</span> messagesList<span class="token punctuation">.</span><span class="token property-access">scrollHeight</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                                </dd>
                                <dt>Testing Tips</dt>
                                <dd><p>Test by sending messages, observing real-time updates, and verifying that the bot's responses stream line by line for an enhanced chat experience.</p></dd>
                            </dl>
                        </dd>
                        <dt>Testing and Improving the Chat Experience</dt>
                        <dd><p>Test the chat flow to ensure messages display correctly, and responses stream as expected. Refine the AI's tone through system prompts in ChatHistory, log key interactions, and optimize the user experience.</p></dd>
                        <dt>Common Issues and Troubleshooting Tips</dt>
                        <dd><p>Troubleshoot OpenAI API key issues, SignalR connectivity problems, and adjust prompt history for enhanced response quality. Ensure connection stability and efficient response streaming.</p></dd>
                        <dt>Extending and Scaling the Chat Application</dt>
                        <dd><p>Consider persisting chat history across sessions for customer support applications, and use Azure SignalR Service for scaling. Future enhancements could include multilingual support and sentiment analysis.</p></dd>
                    </dl>
                    <h2>Conclusion</h2>
                    <p>This guide has shown how to create an AI-enhanced, real-time chat application in PromptSpark using SignalR and Semantic Kernel. By combining real-time messaging with intelligent responses, developers can build highly engaging, adaptive chat experiences. Explore customizations and build unique AI-driven applications in PromptSpark.</p>
                </div>
            </div>
        </article>
        <!-- Auto-include floating LinkedIn share for article pages-->
        <!-- Check if first parameter is an article object-->
        <div class="floating-linkedin-share position-fixed" style="bottom: 20px; right: 20px; z-index: 1000">
            <a class="btn btn-linkedin btn-lg rounded-circle shadow" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fmarkhazleton.com%2Farticles%2Finteractive-chat-in-promptspark-with-signalr-and-semantic-kernel-chat-completions.html&amp;title=Interactive%20Chat%20in%20PromptSpark%20With%20SignalR&amp;summary=Explore%20how%20to%20build%20a%20real-time%2C%20AI-driven%20chat%20application%20in%20PromptSpark%20using%20ASP.NET%20SignalR%20and%20OpenAI%20GPT%20with%20Semantic%20Kernel.&amp;source=Mark%20Hazleton" target="_blank" rel="noopener noreferrer" title="Share on LinkedIn" onclick="return openLinkedInShare(this.href);"><i class="fab fa-linkedin-in"></i></a>
        </div>
        <!-- Footer-->
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <h5 class="mb-3">Mark Hazleton</h5>
                        <p class="text-light">Solutions Architect passionate for solutions which make technology work for business. Lifelong learner, not sidetracked by sizzle.</p>
                        <div class="social-icons">
                            <a href="https://www.linkedin.com/in/markhazleton/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
                                <i class="fab fa-linkedin-in"></i>
                                <span class="visually-hidden">LinkedIn Profile</span>
                            </a>
                            <a href="https://github.com/markhazleton/" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
                                <i class="fab fa-github"></i>
                                <span class="visually-hidden">GitHub Profile</span>
                            </a>
                            <a href="https://www.youtube.com/@MarkHazleton" target="_blank" rel="noopener noreferrer" aria-label="YouTube">
                                <i class="fab fa-youtube"></i>
                                <span class="visually-hidden">YouTube Channel</span>
                            </a>
                            <a href="/rss.xml" target="_blank" rel="noopener noreferrer" aria-label="Articles RSS Feed">
                                <i class="fas fa-rss"></i>
                                <span class="visually-hidden">Articles RSS Feed</span>
                            </a>
                            <a href="/projects-rss.xml" target="_blank" rel="noopener noreferrer" aria-label="Projects RSS Feed">
                                <i class="fas fa-rss"></i>
                                <span class="visually-hidden">Projects RSS Feed.text-warning</span>
                            </a>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <h6 class="mb-3">Quick Links</h6>
                        <ul class="list-unstyled footer-links">
                            <li><a href="/#about">About</a></li>
                            <li><a href="/#experience">Experience</a></li>
                            <li><a href="/projects.html">Projects</a></li>
                            <li><a href="/articles.html">Articles</a></li>
                        </ul>
                    </div>
                    <div class="col-md-3 mb-4">
                        <h6 class="mb-3">Resources</h6>
                        <ul class="list-unstyled footer-links">
                            <li><a href="/projectmechanics/">Project Mechanics</a></li>
                            <li><a href="https://webspark.markhazleton.com">WebSpark</a></li>
                            <li><a href="/rss.xml">Articles RSS Feed</a></li>
                            <li><a href="/projects-rss.xml">Projects RSS Feed</a></li>
                            <li><a href="/sitemap.xml">Sitemap</a></li>
                        </ul>
                    </div>
                </div>
                <hr class="my-4" />
                <div class="row">
                    <div class="col-12 text-center"><p class="mb-0">&copy; 2025 Mark Hazleton. All rights reserved.</p></div>
                </div>
            </div>
        </footer>
        <script src="/js/scripts.js"></script>
    </body>
</html>
