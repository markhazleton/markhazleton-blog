<br />
<!-- Hero Section-->
<section class="bg-gradient-primary py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-10 mx-auto text-center">
                <h1 class="display-4 fw-bold mb-3">
                    <i class="bi bi-cloud me-3"></i>
                    Generating A Key Press Counter with Chat GPT
                </h1>
                <h2 class="subheading mb-4">Exploring User Interaction Patterns with AI Assistance</h2>
            </div>
        </div>
    </div>
</section>
<!-- Main Article Content-->
<article id="main-article">
    <div class="container">
        <div class="row">
            <p class="fw-bold text-primary text-center bg-primary text-white"><a class="fw-bold text-primary text-center bg-primary text-white" href="https://github.com/markhazleton/KeyPressCounter" target="_blank" title="The full source code for the key press counter is available on GitHub">The full source code for the key press counter is available on GitHub</a></p>
            <p class="lead">After a casual comment during one of my daily standups, I got the idea to write a counter program to see how many clicks I do on the computer in a given day.</p>
            <img class="img-fluid" src="/assets/img/ChatGPT-key-press-counter.png" alt="ChatGPT key press logger" title="ChatGPT key press logger" />
            <p>The journey into developing a utility to monitor key and mouse presses unfolded with a focus on user interaction patterns. This post delves into the ethical considerations, the technical setup, and includes snippets of the essential code.</p>
            <p>Explore the development of a key press counter focusing on user interaction, ethical considerations, and technical insights.</p>
            <hr />
            <h2>Ethical Considerations and User Consent</h2>
            <p>In exploring the development of a key press counter, ChatGPT proactively raised ethical considerations, emphasizing the paramount importance of user consent and privacy.</p>
            <blockquote>However, it's important to note that such applications can raise ethical and legal concerns, particularly if they're used without the consent of the person being monitored. Ensure that your application is used in a manner that respects privacy and complies with all relevant laws and guidelines.</blockquote>
            <p>These warnings are a testament to ChatGPT's design, which is ingrained with ethical guidelines to ensure technology serves humanity responsibly. The model's ability to foreground these concerns illustrates its commitment to ethical computing, encouraging developers to prioritize transparency and adherence to privacy laws in their creations. This approach underlines the broader conversation about the responsible use of technology and the role of AI in guiding ethical decision-making in software development.</p>
            <h2>Technical Setup and Code Snippets</h2>
            <p class="lead">Application Development Steps</p>
            <dl>
                <dt>Step 1: Setup Your Development Environment</dt>
                <dd>Install Visual Studio and ensure .NET Framework or .NET Core is set up. Create a new Windows Forms Application project.</dd>
                <dt>Step 2: Implement Global Hooks</dt>
                <dd>Use the `globalmousekeyhook` library to listen for system-wide keyboard and mouse events. Install it via NuGet Package Manager in Visual Studio.</dd>
                <dt>Step 3: Create Event Handlers</dt>
                <dd>Write methods to handle keyboard and mouse events. Increment counters for key presses and mouse clicks within these methods.</dd>
                <dt>Step 4: Log the Activity</dt>
                <dd>Store the counts in a file or database. Use `System.IO.File` methods for file operations, ensuring data is written periodically or upon certain triggers.</dd>
                <dt>Step 5: Build and Test</dt>
                <dd>Compile your project in Visual Studio, fix any errors, and run the application to ensure it tracks key presses and mouse clicks as expected.</dd>
                <dt>Step 6: Ensure Ethical Use</dt>
                <dd>Clearly communicate the application's functionality to users and obtain their consent before use. Consider privacy laws and ethical guidelines.</dd>
            </dl>
            <p>We leveraged global hooks in .NET to monitor activities. Key aspects of the implementation include setting up hooks, event handling, and logging.</p>
            <pre class="language-csharp"><code class="language-csharp"><span class="token comment">// Initialize global hooks</span>
globalHook <span class="token operator">=</span> Hook<span class="token punctuation">.</span><span class="token function">GlobalEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
globalHook<span class="token punctuation">.</span>KeyPress <span class="token operator">+=</span> GlobalHookKeyPress<span class="token punctuation">;</span>
globalHook<span class="token punctuation">.</span>MouseClick <span class="token operator">+=</span> GlobalHookMouseClick<span class="token punctuation">;</span>

<span class="token comment">// Event handler for key presses</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GlobalHookKeyPress</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">KeyPressEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  keyPressCount<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Event handler for mouse clicks</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GlobalHookMouseClick</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">MouseEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  mouseClickCount<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
            <h3>Source Code</h3>
            <p>
                The full source code for the key press counter is available on GitHub. Feel free to explore and adapt it for your projects.
                <a href="https://github.com/markhazleton/KeyPressCounter">Key Press Counter on GitHub</a>
            </p>
            <h2>Reflecting on the Journey</h2>
            <p>This tool serves as a testament to balancing innovation with ethical standards, highlighting the importance of thoughtful software development.</p>
            <p>Incorporating ChatGPT into coding projects not only adds a layer of technological interaction but also brings to light the platform's built-in measures to address ethical implications in its outputs. This aspect of our coding journey highlights the importance of ethical considerations in AI-assisted development, offering a deeper understanding of responsible AI use.</p>
            <h2>Update: Creating a Tray Icon and Balloon Notifications</h2>
            <p>After implementing the key press counter, I decided to enhance the user experience by adding a tray icon and balloon notifications on double click. This allows users to easily access the counter and receive notifications without the need to keep the application window open.</p>
            <h3>Creating the Tray Icon and Balloon Notifications</h3>
            <img class="img-fluid" src="/assets/img/ChatGPT-key-press-counter-tray-icon.png" alt="ChatGPT key press logger tray icon" title="ChatGPT key press logger with tray icon and balloon notifications" />
            <p>To create the tray icon, I used the `NotifyIcon` class from the `System.Windows.Forms` namespace.</p>
            <p>To display balloon notifications on double click, I utilized the `ShowBalloonTip` method of the `NotifyIcon` class.</p>
            <p>With these additions, users can now access the key press counter by double-clicking the tray icon and receive notifications about the counter's status.</p>
            <p>Here's how I achieved this functionality:</p>
            <pre class="language-csharp"><code class="language-csharp">trayIcon <span class="token operator">&amp;</span>#x3D<span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">NotifyIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  Icon <span class="token operator">&amp;</span>#x3D<span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Icon</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>quot<span class="token punctuation">;</span>favicon<span class="token punctuation">.</span>ico<span class="token operator">&amp;</span>quot<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>#x2F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F<span class="token punctuation">;</span> Set your icon here
  ContextMenuStrip <span class="token operator">&amp;</span>#x3D<span class="token punctuation">;</span> <span class="token function">CreateContextMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>#x2F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F<span class="token punctuation">;</span> Optional<span class="token punctuation">:</span> Set <span class="token keyword">if</span> you want a right<span class="token operator">-</span>click menu
  Visible <span class="token operator">&amp;</span>#x3D<span class="token punctuation">;</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  Text <span class="token operator">&amp;</span>#x3D<span class="token punctuation">;</span> <span class="token operator">&amp;</span>quot<span class="token punctuation">;</span>Double Click Icon <span class="token keyword">for</span> Stats<span class="token operator">&amp;</span>quot<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span>#x2F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F<span class="token punctuation">;</span> Optional<span class="token punctuation">:</span> Handle <span class="token keyword">double</span><span class="token operator">-</span>click <span class="token keyword">event</span>
trayIcon<span class="token punctuation">.</span>DoubleClick <span class="token operator">+</span><span class="token operator">&amp;</span>#x3D<span class="token punctuation">;</span> TrayIcon_DoubleClick<span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateTrayIconText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">string</span> log <span class="token operator">&amp;</span>#x3D<span class="token punctuation">;</span> $<span class="token operator">&amp;</span>quot<span class="token punctuation">;</span>\<span class="token class-name">n</span> Keystrokes<span class="token punctuation">:</span> <span class="token punctuation">{</span>keyPressCounter<span class="token punctuation">}</span> \n <span class="token class-name">Mouse</span> Clicks<span class="token punctuation">:</span> <span class="token punctuation">{</span>mouseClickCounter<span class="token punctuation">}</span><span class="token operator">&amp;</span>quot<span class="token punctuation">;</span><span class="token punctuation">;</span>
  trayIcon<span class="token punctuation">.</span><span class="token function">ShowBalloonTip</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>quot<span class="token punctuation">;</span>KeyPressCounter Stats<span class="token operator">&amp;</span>quot<span class="token punctuation">;</span><span class="token punctuation">,</span> $<span class="token operator">&amp;</span>quot<span class="token punctuation">;</span><span class="token punctuation">{</span>log<span class="token punctuation">}</span><span class="token operator">&amp;</span>quot<span class="token punctuation">;</span><span class="token punctuation">,</span> ToolTipIcon<span class="token punctuation">.</span>Info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
            <p>The integration of a tray icon and balloon notifications enhances the usability of the key press counter application. It provides a convenient way for users to access the counter and stay informed about their key press activity. By leveraging ChatGPT and the capabilities of the `NotifyIcon` class, I was able to create a more user-friendly experience.</p>
        </div>
    </div>
</article>
