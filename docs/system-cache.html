<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="author" content="Mark Hazleton" />
        <meta name="robots" content="index, follow" />
        <meta http-equiv="X-Frame-Options" content="DENY" />
        <meta http-equiv="Content-Security-Policy" content="frame-ancestors 'none'" />
        <title>Mark Hazleton - System Cached List</title>
        <meta name="description" content="Mark Hazleton - System Cache List - Enhancing Web API Performance" />
        <meta name="author" content="Mark Hazleton" />
        <link rel="canonical" href="https://markhazleton.controlorigins.com/system-cache.html" />
        <meta property="og:title" content="Mark Hazleton - Solutions Architect" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://markhazleton.controlorigins.com/" />
        <meta property="og:image" content="https://markhazleton.controlorigins.com/assets/img/MarkHazleton.jpg" />
        <meta property="og:description" content="Solutions Architect, lifelong learner, not sidetracked by sizzle. Showcasing a journey of bridging technology with business goals through articles, projects, and professional experiences." />
        <link rel="shortcut icon" href="/assets/img/favicon.ico" />
        <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico" />
        <script type="application/ld+json">
            {
                "@context": "http://schema.org",
                "@type": "Person",
                "name": "Mark Hazleton",
                "familyName": "Hazleton",
                "givenName": "Mark",
                "jobTitle": "Solutions Architect",
                "alumniOf": "University of North Texas",
                "affiliation": {
                    "@type": "Organization",
                    "name": "Control Origins"
                },
                "sameAs": ["https://www.linkedin.com/in/markhazleton/", "https://github.com/markhazleton/", "https://twitter.com/markhazleton/", "https://www.youtube.com/c/MarkHazleton/", "https://markhazleton.brandyourself.com/", "https://www.postman.com/markhazleton/", "https://stackoverflow.com/users/479571/markhazleton/", "https://www.slideshare.net/markhazleton/", "https://hub.docker.com/u/markhazleton/", "https://www.polywork.com/markhazleton/", "https://www.codeproject.com/Members/MarkHazleton/", "https://markhazleton.wordpress.com/", "https://learn.microsoft.com/en-us/users/mark-hazleton/", "https://app.pluralsight.com/profile/markhazletonCEC/", "https://app.pluralsight.com/profile/markhazleton/", "https://www.instagram.com/markhazleton/", "https://storybird.ai/u/markhazleton/", "https://www.pinterest.com/markhazleton/"],
                "url": "https://markhazleton.controlorigins.com"
            }
        </script>
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "Organization",
                "url": "https://markhazleton.controlorigins.com",
                "logo": "https://markhazleton.controlorigins.com/assets/img/MarkHazleton.jpg"
            }
        </script>
        <meta name="seobility" content="f80235aca1a812e0afde44f0142c825b" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link rel="stylesheet" href="/css/styles.css?version=1704561433558" />
        <link href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" rel="stylesheet" type="text/css" />
        <!-- Global site tag (gtag.js) - Google Analytics-->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-L8GVZNDH0B" async></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());
            gtag('config', 'G-L8GVZNDH0B');
        </script>
        <script>
            (function (c, l, a, r, i, t, y) {
                c[a] =
                    c[a] ||
                    function () {
                        (c[a].q = c[a].q || []).push(arguments);
                    };
                t = l.createElement(r);
                t.async = 1;
                t.src = 'https://www.clarity.ms/tag/' + i + '?ref=bwt';
                y = l.getElementsByTagName(r)[0];
                y.parentNode.insertBefore(t, y);
            })(window, document, 'clarity', 'script', 'd628hovv63');
        </script>
    </head>
    <body class="sidetracked-body" id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
            <a class="navbar-brand js-scroll-trigger" href="/#page-top" title="Mark Hazleton">
                <span class="d-block d-lg-none">Mark Hazleton</span>
                <span class="d-none d-lg-block"><img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="/assets/img/MarkHazleton.jpg" alt="..." /></span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/#articles">Articles</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/#projects">Projects</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/#experience">Experience</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/#education">Education</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/projectmechanics/">Project Mechanics</a></li>
                </ul>
            </div>
        </nav>
        <!-- Page Content-->
        <div class="container-fluid p-0">
            <section class="painteddesert-section painteddesert-section-background" id="post">
                <div class="painteddesert-section-content">
                    <h1 class="mb-0">System Cache</h1>
                    <div class="subheading mb-3">Enhancing Web API Performance with a System-Cached List</div>
                    <p class="lead">In the world of web development, performance optimization is a critical aspect that directly influences user experience and overall system efficiency. Caching is a technique that helps to mitigate the load on backend services, reducing response times and enhancing the user experience. One particular approach, the System Cached List, offers a smart and efficient way to cache data and deliver it seamlessly to users. In this article, I will discuss the System Cached List and explore its advantages and disadvantages.</p>
                    <h2>The Challenge: Sub-Second Response Times for a Weather API</h2>
                    <blockquote>You're running a Web API that provides weather forecasts to a large number of users. Each forecast request takes approximately 10 seconds to complete. Your consumers expect near-instantaneous responses and your API is handling thousands of hits every minute.</blockquote>
                    <h2>Caching Strategy:</h2>
                    <dl>
                        <dt>Data Retrieval:</dt>
                        <dd>
                            <ul>
                                <li>When a weather forecast request comes in, the API checks the cache for existing forecast data.</li>
                                <li>If cached data is present the API directly serves the cached data to the user.</li>
                            </ul>
                        </dd>
                        <dt>Cache Miss:</dt>
                        <dd>
                            <ul>
                                <li>If the cache is empty, the API waits for the weather forecast data to be retrieved.</li>
                                <li>If the cache is past the refresh time, the API serves the stale data to ensure a quick response and backend refresh is initiated.</li>
                            </ul>
                        </dd>
                        <dt>Background Cache Refresh:</dt>
                        <dd>
                            <ul>
                                <li>The API kicks off an asynchronous cache refresh process, updating the forecast data in the cache for future requests.</li>
                                <li>This refresh process does not block the main thread, ensuring the API remains responsive.</li>
                                <li>A static boolean is used to ensure only one refresh process is running at a time.</li>
                            </ul>
                        </dd>
                    </dl>
                    <h2>Understanding the System Cached List</h2>
                    <p>The System Cached List is a caching mechanism that maintains a cached dataset, periodically updating it while ensuring minimal impact on the application's performance. This technique employs the power of the MemoryCache class and a custom CachedData class to manage cached data efficiently.</p>
                    <p>
                        I used a minimal Api sample project to start this solution. I then added a generic implementation of caching a list of T using system memory as the caching mechanism. You can view the source for this article in my sandbox repository on GitHub.
                        <a href="https://github.com/markhazleton/sandbox/tree/main/WebApiCache">WebApiCache</a>
                    </p>
                    <h2>Advantages of the System Cached List</h2>
                    <dl>
                        <dt>Improved Performance:</dt>
                        <dd>One of the most significant advantages of the System Cached List is its ability to significantly improve performance by reducing the load on the backend. Instead of hitting the data source every time a request is made, cached data is provided, resulting in faster response times and a smoother user experience.</dd>
                        <dt>Reduced Latency:</dt>
                        <dd>With cached data readily available, there's a notable reduction in latency. Users experience quicker load times, leading to higher satisfaction and engagement levels.</dd>
                        <dt>Efficient Resource Usage:</dt>
                        <dd>By utilizing memory caching, the System Cached List optimizes resource usage. Cached data remains in memory, reducing the need for repeated database queries and subsequent resource consumption.</dd>
                        <dt>Customizability:</dt>
                        <dd>The approach allows customization of cache expiration times. Different datasets might have varying levels of volatility, and the ability to set cache durations accordingly ensures freshness when needed while avoiding unnecessary updates.</dd>
                        <dt>Concurrency Handling:</dt>
                        <dd>The use of synchronization locks in the implementation prevents potential concurrency issues when updating the cache. This ensures that only one thread updates the cache at a time, maintaining data integrity.</dd>
                        <dt>Graceful Update Process:</dt>
                        <dd>The System Cached List employs a smart update process. Instead of blocking the application during data update, it runs the update process asynchronously, thus avoiding any negative impact on user interactions.</dd>
                    </dl>
                    <h2>Disadvantages of the System Cached List</h2>
                    <dl>
                        <dt>Stale Data Risk:</dt>
                        <dd>Depending on the cache expiration settings, there's a risk of serving stale data to users if updates are infrequent or delayed. Careful consideration of cache expiration times is essential to strike the right balance between freshness and efficiency.</dd>
                        <dt>Increased Complexity:</dt>
                        <dd>Implementing a System Cached List requires careful consideration of thread safety, cache management, and update scheduling. This complexity can sometimes lead to potential bugs or challenges in maintenance.</dd>
                        <dt>Memory Usage:</dt>
                        <dd>While memory caching is efficient, it's essential to monitor memory consumption. Storing large datasets in memory can lead to increased memory usage, potentially affecting the overall system's performance.</dd>
                        <dt>Cold Start Overhead:</dt>
                        <dd>When the application starts or the cache expires, there might be a slight overhead as the cache is repopulated. This initial delay could impact the user experience momentarily.</dd>
                    </dl>
                    <h2>Implementing the System Cached List</h2>
                    <p>The provided code snippet showcases the implementation of the System Cached List. The primary components include:</p>
                    <dl>
                        <dt>CachedData Class:</dt>
                        <dd>
                            <p>This class encapsulates the cached data along with metadata such as the last update time and the expected next update time.</p>
                            <pre class="code">
class CachedData
  {
    public DateTime LastUpdated { get; set; }
    public DateTime NextUpdate { get; set; }
    public object Data { get; set; }
  }
</pre
                            >
                        </dd>
                        <dt>SystemValuesCache Class:</dt>
                        <dd>
                            <p>This static class acts as the core of the caching mechanism. It initializes a MemoryCache instance and provides the GetCachedData method to fetch and manage cached data. It also uses a synchronization lock to ensure thread safety.</p>
                            <p>The GetCachedData method's fetchDataFunction argument plays a crucial role in the functionality of the System Cached List. It is a delegate (a type that references a method) that defines a function responsible for retrieving the data that will be cached. This argument essentially tells the caching mechanism how to obtain the fresh data that needs to be cached.</p>
                            <p>In the context of the System Cached List, the fetchDataFunction argument is a callback function provided by the caller of the GetCachedData method. This function is expected to perform the actual data retrieval from the data source, which could be a database, a web API, a file, or any other data repository. The function is asynchronous (Task&lt;List&lt;T&gt;&gt;), indicating that it can be executed in a non-blocking manner, allowing the application to continue functioning while the data retrieval is in progress.</p>
                            <pre class="code">
public static CachedData&lt;T&gt; GetCachedData&lt;T&gt;(
  string cacheKey,
  Func&lt;Task&lt;List&lt;T&gt;&gt;&gt; fetchDataFunction,
  double cacheTimeInSeconds)
{
  List&lt;T&gt; cachedValues = _cache.Get(cacheKey) as List&lt;T&gt; ?? new List&lt;T&gt;();
  if (cachedValues.Count == 0 || DateTime.Now - _lastUpdateTime &gt; TimeSpan.FromSeconds(cacheTimeInSeconds))
  {
    lock (LockObject)
    {
      Task.Run(async () =&gt;
      {
        var data = await fetchDataFunction();
        cachedValues.Clear();
        cachedValues.AddRange(data);
        var cachePolicy = new CacheItemPolicy
        {
          AbsoluteExpiration = DateTimeOffset.Now.AddSeconds(cacheTimeInSeconds)
        };
        _cache.Set(cacheKey, cachedValues, cachePolicy);
        _lastUpdateTime = DateTime.Now;
      }).Wait();
    }
  }
  return new CachedData&lt;T&gt;()
  {
    Data = cachedValues,
    LastUpdateTime = _lastUpdateTime,
    NextUpdateTime = _lastUpdateTime.AddSeconds(cacheTimeInSeconds)
  };
}
</pre
                            >
                        </dd>
                    </dl>
                    <h2>Conclusion</h2>
                    <p>The System Cached List is one approach to enhance the performance of web applications by managing and serving cached data. It combines the efficiency of memory caching with smart update strategies, ensuring users receive quick responses while reducing the load on backend resources. While it offers numerous advantages, it's crucial to carefully consider cache expiration times and handle potential complexities to reap the full benefits of this caching technique.</p>
                </div>
            </section>
            <footer class="navbar-dark bg-primary">
                <div class="row">
                    <div class="col-1"><br /></div>
                    <div class="col-8 text-left text-light">
                        <br />
                        <div class="row">
                            <div class="col-12 col-lg-6 col-xl-4">
                                <h3 class="text-light">ChatGPT</h3>
                                <ul>
                                    <li><a class="text-light" href="/crafting-chatgpt-prompt.html" target="_self" title="Explore the art of crafting effective ChatGPT prompts with Mark Hazleton. Discover the significance of context, learn prompt engineering techniques, and unlock the potential of ChatGPT for better AI-powered conversations and code generation.">Crafting ChatGPT Prompt</a></li>
                                    <li><a class="text-light" href="/creating-a-php-website-with-chat-gpt.html" target="_self" title="Overcoming the Challenge of Unfamiliar Territory">Creating a PHP Website with ChatGPT</a></li>
                                    <li><a class="text-light" href="/trivia-spark-development.html" target="_self" title="Trivia Spark: Igniting Creativity with ChatGPT">Trivia Spark With ChatGPT</a></li>
                                    <li><a class="text-light" href="/using-chatgpt-for-developers.html" target="_self" title="Unlock the potential of ChatGPT for C# development with Mark Hazleton's insightful guide. Explore real-world examples, improve code quality, and enhance developer productivity with ChatGPT. Dive into this comprehensive resource now.">Using ChatGPT for C# Development</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-lg-6 col-xl-4">
                                <h3 class="text-light">Development</h3>
                                <ul>
                                    <li><a class="text-light" href="/cancellation-token.html" target="_self" title="Harnessing the Power of CancellationToken for Efficient and Safe Asynchronous Programming">CancellationToken</a></li>
                                    <li><a class="text-light" href="/concurrent-processing.html" target="_self" title="Learning Concurrent Processing Through Code with ChatGPT">Concurrent Processing</a></li>
                                    <li><a class="text-light" href="/data-analysis-demonstration.html" target="_self" title="Visualizing Data with the Data Analysis Demonstration">Data Analysis Demonstration</a></li>
                                    <li><a class="text-light" href="/git-flow-rethink.html" target="_self" title="Revaluating the meaning of Continuous in CI/CD with Git Flow">Git Flow Rethink</a></li>
                                    <li><a class="text-light" href="/git-organized.html" target="_self" title="Git Organized: A Guide to Organized Version Control">Git Organized</a></li>
                                    <li><a class="text-light" href="/articles/harnessing-the-power-of-caching-in-aspnet-with-memorycachemanager.html" target="_self" title="In the dynamic world of ASP.NET development, optimizing performance is a cornerstone for building successful applications. Caching is one of the most effective strategies for this, and the MemoryCacheManager class is a vital tool in this endeavor. This article dives into its functionalities and benefits, complemented by demonstration code available on GitHub https://github.com/markhazleton/AsyncDemo">Harnessing the Power of Caching in ASP.NET with MemoryCacheManager</a></li>
                                    <li><a class="text-light" href="/nuget-packages-pros-cons.html" target="_self" title="The Pros and Cons of Using NuGet Packages in Your Projects">NuGet Package Pros and Cons</a></li>
                                    <li><a class="text-light" href="/redis-local-instance.html" target="_self" title="Redis Local Instance">Redis Local Instance</a></li>
                                    <li><a class="text-light" href="/sample-mvc-crud.html" target="_self" title="Description for SampleMvcCRUD Project">SampleMvcCRUD Project</a></li>
                                    <li><a class="text-light" href="/system-cache.html" target="_self" title="Enhancing Web API Performance with a System Cached List">System Cache</a></li>
                                    <li><a class="text-light" href="/articles/taking-microsoft-copilot-studio-for-a-test-drive.html" target="_self" title="Mark Hazleton explores Microsoft Copilot Studio, sharing insights on creating a personalized AI chatbot, Copilot Mark. Discover how AI is revolutionizing site interactions and team communication.">Taking Microsoft Copilot Studio for a Test Drive</a></li>
                                    <li><a class="text-light" href="/task-list-processor.html" target="_self" title="Discover how the TaskListProcessor class streamlines concurrent operations in .NET, enabling efficient asynchronous programming and performance monitoring.">Task List Processor</a></li>
                                    <li><a class="text-light" href="/decorator-pattern-http-client.html" target="_self" title="Explore the Decorator Design Pattern applied to an HttpClient in ASP.NET, elucidated by Microsoft ASP.NET Solutions Architect, Mark Hazleton.">The Decorator Pattern with Http Client</a></li>
                                    <li><a class="text-light" href="/articles/building-a-web-application-to-manage-your-blog-articles.html" target="_self" title="Building a Web Application to Manage Your Blog Articles: A Journey into Web Content Management Systems">Tools to Manage My Blog</a></li>
                                    <li><a class="text-light" href="/web-project-mechanics.html" target="_self" title="Description for Web Project Mechanics">Web Project Mechanics</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-lg-6 col-xl-4">
                                <h3 class="text-light">Personal Philosophy</h3>
                                <ul>
                                    <li><a class="text-light" href="/lifelong-learning.html" target="_self" title="Reinventing Yourself: The Transformative Power of Lifelong Learning">Lifelong Learning</a></li>
                                    <li><a class="text-light" href="/sidetrackedbysizzle.html" target="_self" title="Explore the concept of getting Sidetracked By Sizzle with Mark Hazleton. Understand how to stay focused and avoid the allure of superficial attractions.">Sidetracked by Sizzle</a></li>
                                    <li><a class="text-light" href="/articles/the-art-of-making-yourself-replaceable-a-developers-guide-to-career-growth.html" target="_self" title="Explore how developers can enhance their career growth by embracing the concept of making themselves replaceable, focusing on adapting to the evolving tech landscape.">The Art of Making Yourself Replaceable: A Guide to Career Growth</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-lg-6 col-xl-4">
                                <h3 class="text-light">Project Mechanics</h3>
                                <ul>
                                    <li><a class="text-light" href="/projectmechanics/change-management/" target="_self" title="Change management is an important aspect of project management, as it helps to ensure that changes to the project are properly planned and implemented">Change Management</a></li>
                                    <li><a class="text-light" href="/projectmechanics/conflict-management/" target="_self" title="Learn effective conflict management strategies to enhance your project management skills. Discover how to navigate conflicts among team members, clients, and handle poor performance. Ensure project success with these expert tips.">Conflict Management for Project Managers</a></li>
                                    <li><a class="text-light" href="/projectmechanics/change-management/issue-management.html" target="_self" title="issue management. ">Issue Management</a></li>
                                    <li><a class="text-light" href="/projectmechanics/program-management-office.html" target="_self" title="The Program Management Office Role in Project Delivery">Program Management Office</a></li>
                                    <li><a class="text-light" href="/projectmechanics/project-life-cycle.html" target="_self" title="From Idea to Delivery the Project Life Cycle">Project Life Cycle</a></li>
                                    <li><a class="text-light" href="/projectmechanics/" target="_self" title="The Art and Science of Project Management">Project Mechanics</a></li>
                                    <li><a class="text-light" href="/projectmechanics/project-meetings.html" target="_self" title="Project meetings can be the black hole of project management. ">Project Meetings</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-lg-6 col-xl-4">
                                <h3 class="text-light">Project Mechanics Leadership</h3>
                                <ul>
                                    <li><a class="text-light" href="/projectmechanics/leadership/accountability-and-authority.html" target="_self" title="Finding Balance Between Accountability and Authority">Accountability and Authority</a></li>
                                    <li><a class="text-light" href="/projectmechanics/leadership/evolution-over-revolution.html" target="_self" title="Description for Evolution Over Revolution">Evolution Over Revolution</a></li>
                                    <li><a class="text-light" href="/projectmechanics/leadership/from-features-to-outcomes.html" target="_self" title="Focus on outcomes, not just features">From Features to Outcomes</a></li>
                                    <li><a class="text-light" href="/projectmechanics/leadership/" target="_self" title="Project Mechanics Leadership Overview">Leadership</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-3">
                        <br />
                        <div class="social-icons">
                            <a class="social-icon" href="https://www.linkedin.com/in/markhazleton" target="_blank" rel="noopener noreferrer" title="LinkedIn Profile"><i class="fab fa-linkedin-in"></i></a>
                            <a class="social-icon" href="https://github.com/markhazleton" target="_blank" rel="noopener noreferrer" title="GitHub Profile"><i class="fab fa-github"></i></a>
                            <a class="social-icon" href="https://www.youtube.com/@MarkHazleton" target="_blank" rel="noopener noreferrer" title="YouTube Channel"><i class="fab fa-youtube"></i></a>
                            <a class="social-icon" href="https://www.instagram.com/markhazleton/" target="_blank" rel="noopener noreferrer" title="Instagram Profile"><i class="fab fa-instagram"></i></a>
                            <br />
                        </div>
                    </div>
                </div>
            </footer>
            <!-- Bootstrap core JS-->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
            <!-- Core theme JS-->
            <script src="/js/scripts.js"></script>
        </div>
    </body>
</html>
